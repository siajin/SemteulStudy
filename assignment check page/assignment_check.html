<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>DAYMONTH Assignment Check</title>
    <link rel="stylesheet" href="assignment_check.css">
  </head>
  <body>
    <nav>
      <button type="button" id="list_upload_button" onClick:"viewListUpload">UPLOAD</button>
      <button type="button" id="login_button" onClick:"toLogin">LOG IN</button>
    </nav>
    <section>
      <div class="assignment_list">
        <div id="list"></div>
        <div id="list_upload">
        </div>
      </div>
      <div id="calendar"></div>
      <div class="code_view">해당 코드를 보여드립니다(준비중...)</div>
    </section>
  </body>
  <script src="https://unpkg.com/react@17/umd/react.development.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js" crossorigin></script>
  <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
  <script type="text/babel">

    function AssignmentCheck({date, hj, dh, aj, sy}){
      return (
        <div className="assignmentCheck">
          <span style={{
            font-size: 8px;
          }}>{date} </span>
          <Check name="hj", check={hj} />
          <Check name="dh", check={dh} />
          <Check name="aj", check={aj} />
          <Check name="sy", check={sy} />
        </div>
      )
    }
    function Check({check=false, name}{
      return (
        <span style={{
          if(check) backgroundColor: rgb(80, 144, 200);
          font-size: 5px;
        }}>{name} </span>
      );
    }


    function Calendar({today}){
      const [year, setYear] = React.useState(today.year);
      const [month, setMonth] = React.useState(today.month);
      const date = new Date();
      const totalDate = date.getDate(year, month, 0); //month의 일 수
      const prevMonthFinalDate = date.getDate(year, month-1, 0); //month-1의 일 수
      const firstDate = date.getDate(year, month-1, 1); //month의 첫째 요일

      function PrevMonth() {
        if(month==0){
          setMonth(11);
          setYear((current) => current-1);
        }
        else{ setMonth((current) => current-1); }
      }
      function NextMonth() {
        if(month==11){
          setMonth(0);
          setYear((current) => current+1);
        }
        else{ setMonth((current) => current-1); }
      }

      function Day({firstDay, firstDayMonth}){
        const date[6];
        let i=0;

        date[0] = firstDay;
        if(month == firstDayMonth){ //첫날이 해당 달이면
          while(date[i]+7<=totalDate){
            i=i+1;
            date[i]=date[i-1]+7;
          }
          while(i<6){
            i=i+1;
            date[i]=date[i-1]+7-tatalDate;
          }
        }
        else{
          date[1]=date[0]+7-prevMonthFinalDate;
          while(date[i]+7<=totalDate){
            i=i+1;
            date[i]=date[i-1]+7;
          }
          while(i<6){
            i=i+1;
            date[i]=date[i-1]+7-tatalDate;
          }
        }

        return(
          <div className={day}>
            <AssignmentCheck date={date[0]} />
            <AssignmentCheck date={date[1]} />
            <AssignmentCheck date={date[2]} />
            <AssignmentCheck date={date[3]} />
            <AssignmentCheck date={date[4]} />
            <AssignmentCheck date={date[5]} />
          </div>
        );
      }

      let i=1;
      const firstWeek[6];
      firstWeek[firstDay]=1;
      const firstWeekMonth[6];
      firstWeekMonth[firstDay]=month;
      while(firstDay-i>=0){
        firstWeekMonth[firstDay-i]=(month==0? 11:month-1);
        firstWeek[firstDay-i]=prevMonthFinalDate-i+1;
        i=i+1;
      }
      i=1;
      while(firstDay+i<7){
        firstWeekMonth[firstDay+i]=i+1;
        firstWeek[firstDay+i]=month;
        i=i+1;
      }


      return (
        <div className="show_calendar">
          <h1>calendar</h1>
          <div>{year}</div>
          <div className="month">
            <div onClick={PrevMonth}>{month==0? 12:month-1} </div>
            {month}
            <div onClick={NextMonth}> {month==11? 1:month+1}</div>
          </div>

          <div className="days">
            <div className="SUN">SUN
              <Day firstDay={firstWeek[0]} firstDayMonth={firstWeekMonth[0] />
            </div>
            <div className="MON">MON
              <Day firstDay={firstWeek[0]} firstDayMonth={firstWeekMonth[0] />
            </div>
            <div className="TUE">TUE
              <Day firstDay={firstWeek[2]} firstDayMonth={firstWeekMonth[2] />

            </div>
            <div className="WED">WED
              <Day firstDay={firstWeek[3]} firstDayMonth={firstWeekMonth[3] />

            </div>
            <div className="THU">THU
              <Day firstDay={firstWeek[4]} firstDayMonth={firstWeekMonth[4] />

            </div>
            <div className="FRI">FRI
              <Day firstDay={firstWeek[5]} firstDayMonth={firstWeekMonth[5] />

            </div>
            <div className="SAT">SAT
              <Day firstDay={firstWeek[6]} firstDayMonth={firstWeekMonth[6] />

            </div>

          </div>
        </div>

      );
    }


    const calendar = document.getElementById("calendar");

    function App(){
      var date = new Date();
      const today = {
        year: date.getFullYear(),
        month: date.getMonth()+1, //month는 0-11
        date: date.getDate(), //일
        day: date.getDay()
      };

      console.log("?");
      return (
        <Calendar today={today} />
      );
    }

    ReactDOM.render(<App />, calendar);
  </script>
  //<script src="assignment_check.js" charset="utf-8"></script>
</html>
